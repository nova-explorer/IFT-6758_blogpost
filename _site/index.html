<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      IFT6758 Blog A-09 &middot; Data science on NHL data
    
  </title>

  
  <link rel="canonical" href="http://localhost:4000/">
  

  <link rel="stylesheet" href="http://localhost:4000/public/css/poole.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/syntax.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://localhost:4000/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml">

  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Projet de science des données dans le cadre du cours IFT-6758 de UdeM. Le projet concerne les données de la LNH.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item active" href="http://localhost:4000/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="http://localhost:4000/about/">About</a>
        
      
    
      
    

    <span class="sidebar-nav-item">Currently v1.1.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2023. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">IFT6758 Blog A-09</a>
            <small>Data science on NHL data</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:4000/2023/10/10/milestone-1/">
        Milestone 1
      </a>
    </h1>

    <span class="post-date">10 Oct 2023</span>

    <h2 id="section-1--acquisition-de-données">Section 1 : Acquisition de données</h2>

<h3 id="question-11">Question 1.1</h3>

<div class="message">
    Rédigez un bref tutoriel sur comment votre équipe a téléchargé l'ensemble de données. Imaginez que vous cherchiez un guide sur comment télécharger les données play-by-play; votre guide devrait vous faire dire "Parfait - c'est exactement ce que je cherchais!". Incluez votre fonction/classe et fournissez un exemple de son utilisation.
</div>

<p>Les données que nous désirons acquérir sont disponibles à partir d’un API utilisant des url telles que :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://statsapi.web.nhl.com/api/v1/game/2017020001/feed/live/
</code></pre></div></div>

<p>où <code class="language-plaintext highlighter-rouge">2017020001</code> correspond au game_id de la partie. Le game_id est composé de trois sections, soit l’année de la saison (2017), le type de saison (02) et le numéro de la partie (0001). Les types de saison nous intéressant sont 02 pour les saisons régulières. Pour obtenir l’entièreté de la saison régulière de 2016, on peut simplement itérer sur le numéro de la partie en utilisant :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">access_point</span> <span class="o">=</span> <span class="s">"https://statsapi.web.nhl.com/api/v1/game/"</span>
<span class="n">season</span> <span class="o">=</span> <span class="mi">2016</span>
<span class="n">game_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">game_id_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s">02</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">game_id</span><span class="p">).</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s">"</span>
<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">access_point</span><span class="si">}{</span><span class="n">game_id_str</span><span class="si">}</span><span class="s">/feed/live/"</span>
</code></pre></div></div>

<p>et augmenter game_id. On peut alors définir le nom du fichier où les données seront sauvegardées afin de vérifier s’il existe déjà localement et ne pas le télécharger.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">save_directory</span> <span class="o">=</span> <span class="s">"../NHLGameData"</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_directory</span><span class="p">,</span> <span class="sa">f</span><span class="s">"game_</span><span class="si">{</span><span class="n">game_id_str</span><span class="si">}</span><span class="s">.json"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="c1">#do not download filename and continue to next file
</span>    <span class="n">game_id</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">continue</span>
</code></pre></div></div>

<p>Dans le cas ᴏù nous voulons télécharger le fichier, il nous faudra commencer par vérifier si celui-ci existe dans l’API.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="c1"># download file
</span><span class="k">elif</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
    <span class="c1"># Game not found, exit the loop
</span>    <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error in regular match ID </span><span class="si">{</span><span class="n">game_id_str</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<p>Si la partie existe et est accessible, le code renvoyé sera 200. Si la partie n’existe pas (erreur 404), cela veut dire que le game_id présent est devenu trop haut et il est nécessaire de quitter la boucle d’itération de match afin de ne pas faire des demandes inutiles à l’API. Si un autre code est renvoyé, cela n’est pas normal et il est intéressant de le notifier dans l’interface. Finalement, si on veut télécharger le fichier, il est nécessaire de savoir que l’API enregistre ses données en format json. On peut donc accéder aux données pertinentes et les téléchargées dans un fichier.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">playByPlay</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'liveData'</span><span class="p">][</span><span class="s">'plays'</span><span class="p">][</span><span class="s">'allPlays'</span><span class="p">]</span>
<span class="n">home_team</span> <span class="o">=</span> <span class="n">responses</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'gameData'</span><span class="p">][</span><span class="s">'teams'</span><span class="p">][</span><span class="s">'home'</span><span class="p">][</span><span class="s">'name'</span><span class="p">]</span>
<span class="n">away_team</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'gameData'</span><span class="p">][</span><span class="s">'teams'</span><span class="p">][</span><span class="s">'away'</span><span class="p">][</span><span class="s">'name'</span><span class="p">]</span>
<span class="n">periods</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'liveData'</span><span class="p">][</span><span class="s">'linescore'</span><span class="p">][</span><span class="s">'periods'</span><span class="p">]</span>

<span class="c1"># create and save the json informations into the file
</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="n">data_to_save</span> <span class="o">=</span> <span class="p">{</span><span class="s">"playByPlay"</span><span class="p">:</span> <span class="n">playByPlay</span><span class="p">,</span><span class="s">"periods"</span><span class="p">:</span> <span class="n">periods</span><span class="p">,</span> <span class="s">"home"</span><span class="p">:</span> <span class="n">home_team</span><span class="p">,</span> <span class="s">"away"</span><span class="p">:</span> <span class="n">away_team</span><span class="p">}</span>
    <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data_to_save</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="section-2--débogage-interactif">Section 2 : Débogage interactif</h2>

<h3 id="question-21">Question 2.1</h3>

<div class="message">
    Implémentez un ipywidget qui vous permet de parcourir tous les événements, pour chaque match d'une saison donnée, avec la possibilité de changer entre la saison régulière et les séries éliminatoires. Dessinez les coordonnées de l'événement sur l'image de la patinoire fournie, similaire à l'exemple ci-dessous (vous pouvez simplement imprimer les données de l'événement lorsqu'il n'y a pas de coordonnées). Vous pouvez également imprimer toutes les informations que vous jugez utiles, telles que les métadonnées du jeu/boxscores et les résumés des événements (mais ce n'est pas obligatoire). Prenez une capture d'écran de l'outil et ajoutez-la à l’article de blog, accompagnée du code de l'outil et d'une brève description (1-2 phrases) de ce que fait votre outil. Vous n'avez pas à vous soucier de l'intégration de l'outil dans le blogpost.
</div>

<p>…content…</p>

<h2 id="section-4--nettoyer-les-données">Section 4 : Nettoyer les données</h2>

<h3 id="question-41">Question 4.1</h3>
<div class="message">
    Dans votre article de blog, incluez un petit extrait de votre dataframe final (par exemple, en utilisant head(10)). Vous pouvez simplement inclure une capture d'écran plutôt que de vous battre pour que les tableaux soient soigneusement formatés en HTML/markdown.
</div>

<p>…content…</p>

<h3 id="question-42">Question 4.2</h3>
<div class="message">
    Vous remarquerez que le champ de « force » (c.-à-d. égal, avantage numérique ou en désavantage numérique) n'existe que pour les buts, pas pour les tirs. De plus, il n'inclut pas la force réelle des joueurs sur la glace (c'est-à-dire 5 contre 4, ou 5 contre 3, etc.). Discutez de la façon dont vous pourriez ajouter les informations sur la force réelle (c'est-à-dire 5 contre 4, etc.) aux tirs et aux buts, compte tenu des autres types d'événements (autre que ces derniers) et des autres données disponibles. Vous n'avez pas besoin d’implémenter cette fonctionnalité pour ce milestone.
</div>

<p>…content…</p>

<h3 id="question-43">Question 4.3</h3>
<div class="message">
    En quelques phrases, discutez d’au moins 3 caractéristiques supplémentaires que vous pourriez envisager de créer à partir des données disponibles dans cet ensemble de données. Nous ne cherchons pas de réponses particulières, mais si vous avez besoin d'inspiration, un tir ou un but pourrait-il être classé comme un rebond/tir en contre-attaque (expliquez comment identifier ceux-ci)?
</div>

<p>…content…</p>

<h2 id="section-5--visualisations-simples">Section 5 : Visualisations simples</h2>

<h3 id="question-51">Question 5.1</h3>
<div class="message">
    Produisez un graphique comparant les types de tirs de toutes les équipes dans une saison de votre choix (i.e. agrégez juste sur tous les tirs). Superposez le nombre de buts sur le nombre de tirs. Quel semble être le type de tir le plus dangereux? Le type de tir le plus courant? Pourquoi est-ce que vous avez choisi ce type de graphique? Ajoutez ce graphique et cette discussion à votre article de blog.
</div>

<p>…content…</p>

<h3 id="question-52">Question 5.2</h3>
<div class="message">
    Quelle est la relation entre la distance à laquelle un tir a été effectué et la chance qu'il s'agisse d'un but? Produisez un graphique pour chaque saison entre 2018-19 et 2020-21 pour répondre à cette question, et ajoutez-le à votre article de blog avec quelques phrases décrivant le graphique. Y a-t-il eu beaucoup de changements au cours des trois dernières saisons? Pourquoi est-ce que vous avez choisi ce type de graphique?
        a.	Trouver la distance du tir nécessite la combinaison de plusieurs des données, c’est à vous de trouver une méthode qui fonctionne pour la majorité des parties (certaines ont des informations manquantes).
        b.	Si vous notez quelques données aberrantes, ne vous inquiétez pas, on en reparlera dans le milestone 2.

</div>

<p>…content…</p>

<h3 id="question-53">Question 5.3</h3>
<div class="message">
    Combinez les informations des sections précédentes pour produire un graphique qui montre le pourcentage de buts (# buts / # tirs) en fonction à la fois de la distance par rapport au filet et de la catégorie de types de tirs (vous pouvez choisir une seule saison de votre choix). Discutez brièvement de vos conclusions. Par exemple, quels sont les types de tirs les plus dangereux?
</div>

<p>…content…</p>

<h2 id="section-6--visualisations-avancées">Section 6 : Visualisations avancées</h2>

<h3 id="question-61">Question 6.1</h3>
<div class="message">
    Exportez les 4 graphiques de zone offensive au format HTML et intégrez-les dans votre article de blog. Votre graphique doit permettre aux utilisateurs de sélectionner n'importe quelle équipe pour la saison sélectionnée.
    Note: Parce que vous pouvez trouver ces graphiques sur l’internet, répondre à ces questions sans produire ces graphiques ne vous rapportera pas de points !
</div>

<p>…content…</p>

<h3 id="question-62">Question 6.2</h3>
<div class="message">
    Discutez (en quelques phrases) de ce que vous pouvez interpréter à partir de ces graphiques.
</div>

<p>…content…</p>

<h3 id="question-63">Question 6.3</h3>
<div class="message">
    Considérez l'Avalanche du Colorado; jetez un œil à leur carte de tir au cours de la saison 2016-17. Discutez de ce que vous pourriez dire sur l'équipe au cours de cette saison. Regardez maintenant la carte de tirs de l'Avalanche du Colorado pour la saison 2020-21 et discutez de ce que vous pouvez conclure de ces différences. Est-ce que ça a du sens? Astuce : regardez le classement.
</div>

<p>…content…</p>

<h3 id="question-64">Question 6.4</h3>
<div class="message">
    Considérez les Sabres de Buffalo, une équipe qui a connu des difficultés ces dernières années, et comparez-les au Lightning de Tampa Bay, une équipe qui a remporté la coupe Stanley pour deux années consécutives. Regardez les plans de tir de ces deux équipes des saisons 2018-19, 2019-20 et 2020-21. Discutez des observations que vous pouvez faire. Y a-t-il quelque chose qui pourrait expliquer le succès du Lightning, ou les problème des Sabres ? Est-ce que ces images sont suffisantes pour tout comprendre les succès ou problèmes d’une équipe?
</div>

<p>…content…</p>

  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item older">Older</span>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
